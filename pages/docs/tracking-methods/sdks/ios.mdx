import { Callout } from 'nextra/components'

# Mixpanel SDKs: iOS (Objective-C)

## Getting Started

Please refer to our [Quickstart Guide](/docs/quickstart/connect-your-data?sdk=ios).

The [Full API Reference](https://mixpanel.github.io/mixpanel-iphone/index.html), [Library Source Code](https://github.com/mixpanel/mixpanel-iphone/), and an [Example Application](https://github.com/mixpanel/mixpanel-iphone/tree/master/HelloMixpanel) is documented in our GitHub repo.

## Installing the Library

You can install the Objective-C library by using CocoaPods, Carthage, or Swift Package Manager.

**Installation Option 1: CocoaPods**

1. Install CocoaPods by typing the following in your command line:

```bash
gem install cocoapods
```

2. Creae a local CocoaPods spec mirror:

```bash
pod setup
```

3. Navigate to your Xcode project directory and create a Podfile:

```bash
pod init
```

4. Edit the Podfile that is generated from step 3, adding the following line: `pod 'Mixpanel'`

5. Install the Mixpanel library and create a new Xcode workspace by running the following in the Xcode project directory:

```bash
pod install
```

**Installation Option 2: Carthage**

Mixpanel supports [Carthage](https://github.com/Carthage/Carthage#quick-start) to package your dependencies as a framework. Include the following dependency in your Cartfile:

```bash
github "mixpanel/mixpanel-iphone"
```

**Installation Option 3: Swift Package Manager**

1. In Xcode, select File > Add Packages...

2. Enter the package URL for [this repository](https://github.com/mixpanel/mixpanel-iphone) and select version v4.0.0 or above.

After installing the library, import the library into `AppDelegate.m` and create an instance of Mixpanel using [`sharedInstanceWithToken:`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/sharedInstanceWithToken:) with your project token inside [`application:didFinishLaunchingWithOptions:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate#//apple_ref/occ/intfm/UIApplicationDelegate/application:willFinishLaunchingWithOptions:).

```objc Objective-C
//import library to AppDelegate
#import "Mixpanel/Mixpanel.h"

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
...
  //create Mixpanel instance
  [Mixpanel sharedInstanceWithToken:@"YOUR_PROJECT_TOKEN" trackAutomaticEvents:NO];
...
}
```

### Library Configuration

The library can be initialized with different configurations. See a complete list of the configuration options [here](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/sharedInstanceWithToken:).

**Example Usage**

```objc Objective-C
//import library to AppDelegate
#import "Mixpanel/Mixpanel.h"

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
...
  //create Mixpanel instance with trackCrashes enabled
  [Mixpanel sharedInstanceWithToken:@"YOUR_PROJECT_TOKEN" trackAutomaticEvents:NO trackCrashes:YES];
...
}
```

## Sending Events

Use [`track:properties:`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/track:properties:) to send an event by providing the event name and any event properties. This will trigger a request to the [/track API endpoint](https://developer.mixpanel.com/reference/track-event) to ingest the event into your project.

<Callout type="info">
  The [/track endpoint](https://developer.mixpanel.com/reference/track-event) will only validate events with timestamps within the last 5 days of the request. Events with timestamps older than 5 days will not be ingested. See below on best practices for historical imports.
</Callout>

**Example Usage**
```objc Objective-C
// send "some_event"
// with "Plan" event prop set to "Premium"
Mixpanel *mixpanel = [Mixpanel sharedInstance];
[mixpanel track:@"some_event"
     properties:@{ @"Plan": @"Premium" }];
```


### Timing Events

You can track the time it took for an action to occur, such as an image upload or a comment post, using [`timeEvent:`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/timeEvent:). This will mark the "start" of your action, which you can then finish with a track call. The time duration is then recorded in the "Duration" property.

**Example Usage**
```objc Objective-C
Mixpanel *mixpanel = [Mixpanel sharedInstance];

// start the timer for the event "Image Upload"
[mixpanel timeEvent:@"Image Upload"];

// 20 seconds later...

[self uploadImageWithSuccessHandler:^{
    //// track "Image Upload" event with "Duration" event prop set to 20
    [mixpanel track:@"Image Upload"];
}];
```

### Flushing Events
To preserve battery life and customer bandwidth, the Mixpanel library doesn't send the events you record immediately. Instead, it sends batches to the Mixpanel servers every 60 seconds while your application is running, as well as when the application transitions to the background. 

Call [`flush`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/flush) manually if you want to force a flush at a particular moment.

**Example Usage**
```objc Objective-C
Mixpanel *mixpanel = [Mixpanel sharedInstance];

// flush batched events for ingestion immediately
[mixpanel flush];
```

**Flush Interval**

You can update the default flush interval from 60 seconds to another interval using [`flushInterval`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/flushInterval).

**Example Usage**
```objc Objective-C
Mixpanel *mixpanel = [Mixpanel sharedInstance];

//set the flush interval to every 120 seconds
[Mixpanel sharedInstance].flushInterval = 120;
```

#### Importing Historical Events

The Objective-C SDK is a tracking SDK designed for real-time tracking in a client-side environment. Calling `track:properties:` triggers a request to our [/track API endpoint](https://developer.mixpanel.com/reference/track-event), which will validate for events with a timestamp that is within the last 5 days of the request. **Events older than 5 days will not be ingested**.

For bulk import of historical events older than 5 days, we will need to use the [/import API endpoint](https://developer.mixpanel.com/reference/import-events) which is optimized for scripting and supports ingesting historical data. We recommend the [Python SDK](/docs/tracking-methods/sdks/python) (see the [`.import_data()`](https://mixpanel.github.io/mixpanel-python/#primary-interface) function) and [mixpanel-utils module](https://github.com/mixpanel/mixpanel-utils) (see the [`import_events()`](https://github.com/mixpanel/mixpanel-utils?tab=readme-ov-file#import-events) function) which both leverages the /import API for event ingestion.

## Setting Super Properties

Super properties are global event properties that you define once and apply to all events.

To register super properties, call [`registerSuperProperties:`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/registerSuperProperties:)

Use [`registerSuperPropertiesOnce:`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/registerSuperPropertiesOnce:) to register super properties without overwriting existing values.


```objc Objective-C
Mixpanel *mixpanel = [Mixpanel sharedInstance];

// register "name" as a super property
[mixpanel registerSuperProperties:@{@"Name": @"Sam"}];

// track "some_event"
// "Name" event prop is included in the event
[mixpanel track:@"some_event"];

// ignored since "name" already exists
[mixpanel registerSuperPropertiesOnce:@{@"Name": @"Samantha"}];
```

Our mobile libraries store your super properties in local storage. They will persist so long as the app is installed (between launches and updates). Uninstalling the app will remove that customers super properties.

See more methods related to super properties in the complete library reference [here](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#).


## Managing User Identity

You can handle the identity of a user using the [identify](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/identify:) and [alias](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/alias) methods. Proper use of these methods can connect events to the correct user as they move across devices, browsers, and other platforms. 

#### Identify
Identify a user with a unique ID to track user activity across devices, tie a user to their events, and create a user profile. If you never call this method, unique visitors are tracked using a UUID that generates the first time they use the app.

Call `identify` when you know the identity of the current user, typically after log-in or sign-up. We recommend against using `identify` for anonymous visitors to your site. 
```objc Objective-C
// Ensure all future events sent from
// the device will have the distinctId 13793
[mixpanel identify:@"13793"];
```



### Call Reset at Logout

Reset generates a new random distinct_id and clears super properties. Call reset to clear data attributed to a user when that user logs out. This allows you to handle multiple users on a single device. For more information about maintaining user identity, see the [Identifying Users](/docs/tracking-methods/id-management/identifying-users) article.

Beginning with version v3.6.2, Mixpanel no longer uses the IFA(ID for Advertisers) but uses a randomly generated UUID as the default distinct ID instead. After you call reset, Mixpanel generates a new distinct_id.

If you want to use IFV(identifierForVendor) as the distinct_id, you can set
`MIXPANEL_UNIQUE_DISTINCT_ID=1` in build settings `Preprocessor Macros` on the Mixpanel framework target. After you call reset, the IFV will not change. However, when a user removes and then re-installs the app, the IFV will change with each installation.


## Storing User Profiles

In addition to events, you can store user profiles in Mixpanel. Profiles are persistent sets of properties that describe a user—things like name, email address, and signup date.

You can use profiles to explore and segment users by who they are, rather than what they did. 

### Setting Profile Properties
You can set properties on a user profile with [`people.set:`](https://mixpanel.github.io/mixpanel-iphone/Classes/MixpanelPeople.html#//api/name/set:).

Updates to user profiles are queued on the device until [`identify`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/identify:) is called.

```objc Objective-C
// Sets user 13793's "Plan" attribute to "Premium"
[mixpanel.people set:@{@"Plan": @"Premium"}];
```

This will set a "Plan" property, with a value "Premium", on user 13793's profile. If there isn't a profile with distinct_id 13793 in Mixpanel already, a new profile will be created. If user 13793 already has a property named "Plan" in their profile, the old value will be overwritten with "Premium".

### Incrementing Numeric Properties
You can use [`people increment:`](https://mixpanel.github.io/mixpanel-iphone/Classes/MixpanelPeople.html#//api/name/increment:) to change the current value of numeric properties. This is useful when you want to keep a running tally of things, such as games played, messages sent, or points earned.

```objc Objective-C
// Here we increment the user's point count by 500.
[mixpanel.people increment:@"point count" by:@500];

// Pass an NSDictionary to increment multiple properties
[mixpanel.people increment:@{
    @"dollars spent": @17,
    @"credits remaining": @-34
}];
```

### Other Types of Profile Updates
There are a few other types of profile updates. To learn more, please review the full [MixpanelPeople API documentation](https://mixpanel.github.io/mixpanel-iphone/Classes/MixpanelPeople.html).

## Tracking Revenue

Mixpanel makes it easy to analyze the revenue you earn from individual customers. By associating charges with user profiles, you can compare revenue across different customer segments and calculate things like lifetime value.

You can track a single transaction with [`people trackCharge:`](https://mixpanel.github.io/mixpanel-iphone/Classes/MixpanelPeople.html#//api/name/trackCharge:). This call will add transactions to the individual user profile, which will also be reflected in the Mixpanel Revenue report.
```objc Objective-C
// Tracks $100.77 in revenue for user 13793
[mixpanel.people trackCharge:@(100.77)];

// Refund this user $50
[mixpanel.people trackCharge:@-50];

// Tracks $25 in revenue for user 13793 on the 2nd of
// January
[mixpanel.people trackCharge:@25 withProperties:@{
    @"$time": "2016-01-02T00:00:00"
}];
```

## Group Analytics
Mixpanel Group Analytics is a paid add-on that allows behavioral data analysis by selected groups, as opposed to individual users.

Grouping by identifiers other than the `distinct_id` will allow analysis at a company or group level when using Mixpanel analytics. Read [this article](/docs/data-structure/advanced/group-analytics) to learn more about Group Analytics.

A group is identified by the `group_key` and `group_id`.
* `group_key` is the property that connects event data for Group Analytics.
* `group_id` is the identifier for a specific group.

If the property “company” is chosen for Group Analytics, “company” is the `group_key`, and “Mixpanel”, “Company A”, and “13254” are all potential `group_id` values. 

A user can belong to multiple groups. All updates to a group operate on the `group_key` and `group_id`.

### Creating a Group Key
Administer group keys through your Project Settings. Group keys are event properties. All events need to have a defined group key on them in order to be attributed to a group. Group keys are project specific, and the group key should be set up before group data is sent. Note that Mixpanel does not backfill historical data before the group key was implemented.

To administer group keys, navigate to your Project Settings. Click **+Add Group Key** under the *GROUP KEYS* section.

### Creating Group Profiles
It is possible to create a Group profile that is similar to a user profile. You must call [`getGroup().set()`](https://mixpanel.github.io/mixpanel-iphone/Classes/Mixpanel.html#//api/name/getGroup:groupID:) to build a group profile. It is important to the `group_key`, `group_id`, and one property so that the profile is not empty. 

```objc Objective-C
[[self.mixpanel getGroup:@"Company", groupID:@“Mixpanel”] set:@{@"h": @"yo”}]；
```

### Setting Group Profile Properties
You can add details to Groups by adding properties to them.

In order to update Group profile properties, you must specify the group that needs to be updated by calling [`getGroup():groupID()`](https://mixpanel.github.io/mixpanel-swift/Classes/Group.html#/s:8Mixpanel5GroupC3set10propertiesySDySSAA0A4Type_pG_tF).

The `getGroup():groupID()` method can be chained with other commands that edit properties specific to the group.

You can set the property `$name` to populate the name field at the top of the group profile.

These operations are similar to the corresponding operations for user profile property updates.
```objc Objective-C
[[self.mixpanel getGroup:@"Company", groupID:@“Mixpanel”] set:@{@"h": @"yo”}]；
```

You can see other Group methods in the [reference](https://mixpanel.github.io/mixpanel-swift/Classes/Group.html).

## Debugging and Logging

You can turn on Mixpanel logging by setting the `enableLogging` flag
```objc Objective-C
[Mixpanel sharedInstance].enableLogging = YES;
```

Alternatively, you can add the following Preprocessor Macros in Build Settings:

* `MIXPANEL_DEBUG=1` - logs queueing and flushing of events to Mixpanel
* `MIXPANEL_ERROR=1` - logs any errors related to connections or malformed events

If you're using CocoaPods, you'll need to add this to the Pod target instead of your main app project's target:

![image](/230696566-ee7da1ce-0f45-4da1-9083-e5d05f0b2603.png)


You can also add this to your Podfile to ensure everyone on your team will always have logging enabled:

```ruby Ruby
post_install do |installer|
  installer.pods_project.targets.each do |target|
    target.build_configurations.each do |config|
      settings = config.build_settings['GCC_PREPROCESSOR_DEFINITIONS']
      settings = ['$(inherited)'] if settings.nil?

      if target.name == 'Pods-MyProject-Mixpanel'
        settings << 'MIXPANEL_DEBUG=1'
        settings << 'MIXPANEL_ERROR=1'
      end

      config.build_settings['GCC_PREPROCESSOR_DEFINITIONS'] = settings
    end
  end
end
```

## EU Data Residency

Route data to Mixpanel's EU servers by setting the `serverURL` property after initializing the client. 

```objc
self.mixpanel = [Mixpanel sharedInstanceWithToken:@"MIXPANEL_TOKEN" launchOptions:launchOptions];
self.mixpanel.serverURL = @"https://api-eu.mixpanel.com";
```

## Types
Avoid Objective-C primitives for property values because these non-object types cannot be placed in the NSDictionary for event and user profile properties.

Use `NSString` for strings, `NSDate` for dates, `NSBool` for booleans, `NSArray` for arrays, and `NSNumber` for numbers.

For dates, we recommend formatting as ISO8601 UTC dates: "YYYY-MM-DDThh:mm:ss".

## [Legacy] Automatically Tracked Events

Mixpanel's SDKs have a legacy feature to automatically collect common mobile events. We don't recommend enabling this, as these events rely on client-side state and can be unreliable.

| Raw Name | Display Name | Description |
| --- | --- | --- |
| $ae_first_open | First App Open | Tracks the first time the user has opened the app. This event is retriggered if the user reinstalls the app or clears local storage. A user property First App Open Date (`$ae_first_app_open_date`) is tracked to indicate the date when app was first opened. |
| $ae_updated | App Updated | Executes when a user updates the app from the previous version. A Version Updated (`$ae_updated_version`) property is tracked to store the new app version. |
| $ae_crashed | App Crashed | Executes when Mixpanel receives either an exception or a signal that indicated the app has crashed. A Crash Reason (`$ae_crashed_reason`) property is tracked to help identify the type of crash. |
| $ae_session | App Session | Executes when a user spends more than 10 seconds in the app. A Session Length (`$ae_session_length`) property is tracked to reflect the number of seconds user spent in the session. In addition, there are two user properties tracked: Total App Sessions (`$ae_total_app_sessions`) and Total App Session Length (`$ae_total_app_session_length`). |
| $ae_iap | In App Purchase (IAP) | Executes when a user conducts an in-app purchase through your app. Mixpanel provides three properties for this event: Product Name (`$ae_iap_name`), Product Quantity (`$ae_iap_quantity`), and Product Price (`$ae_iap_price`). |

## Release History
[See All Releases](https://github.com/mixpanel/mixpanel-iphone/releases).
